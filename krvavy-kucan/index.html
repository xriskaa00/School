
<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Krvav√Ω K√∫can</title>

    <!-- Extern√© kni≈ænice -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- Vlastn√© ≈°t√Ωly -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Aplik√°cia -->
    <script src="app.js" defer></script>
</head>
<body>

<div class="embers"></div>

<!-- Lobby -->
<div id="lobby" class="fixed inset-0 z-[3000] flex items-center justify-center p-6 text-center">
    <div class="lobby-box bg-gradient-to-br from-gray-900/95 via-black/95 to-gray-900/95 p-12 rounded-3xl border-2 border-red-900 w-full max-w-md shadow-2xl relative backdrop-blur-sm">
        <div class="absolute inset-0 rounded-3xl opacity-20" style="background: radial-gradient(circle at center, rgba(139,0,0,0.3), transparent);"></div>

        <h1 class="lobby-title relative text-5xl font-black text-red-700 mb-8 uppercase italic tracking-widest">KRVAV√ù K√öCAN</h1>

        <div class="lobby-input relative mb-4">
            <div class="input-icon">üö™</div>
            <input id="joinRoom" type="text" placeholder="K√ìD MIESTNOSTI" class="w-full bg-black/80 p-5 pl-14 border-2 border-gray-800 rounded-xl text-white uppercase outline-none font-bold tracking-wider backdrop-blur-sm transition-all duration-300 lobby-input">
        </div>

        <div class="lobby-input relative mb-6">
            <div class="input-icon">üë§</div>
            <input id="joinName" type="text" placeholder="TVOJE MENO" class="w-full bg-black/80 p-5 pl-14 border-2 border-gray-800 rounded-xl text-white outline-none tracking-wide backdrop-blur-sm transition-all duration-300 lobby-input">
        </div>

        <button onclick="enterGame(false)" class="lobby-button relative w-full bg-gradient-to-r from-red-700 to-red-600 hover:from-red-600 hover:to-red-500 p-5 rounded-xl font-bold mb-3 uppercase transition-all duration-300 shadow-lg hover:shadow-red-900/50 hover:scale-105">
            üé≠ Vst√∫pi≈• ako Hr√°ƒç
        </button>

        <button onclick="enterGame(true)" class="lobby-button relative w-full bg-gradient-to-r from-red-900/50 to-red-800/50 hover:from-red-900/70 hover:to-red-800/70 p-5 rounded-xl font-bold border-2 border-red-700 uppercase transition-all duration-300 shadow-lg hover:scale-105">
            üìñ Storyteller
        </button>

        <div class="mt-6 text-center text-gray-500 text-[10px] uppercase tracking-widest" style="font-family: 'Cinzel', serif; opacity: 0.6; animation: footer-fade 1.5s ease-out 1.4s both;">
            By JumalaLuke &amp; Yuuki
        </div>
    </div>
</div>

<!-- Game Grid -->
<div id="gameRoot" class="hidden grid-layout">
    <header id="mainHeader" class="col-span-3 flex items-center justify-between px-8">
        <div class="flex items-center gap-4 text-sm">
            <div class="text-white font-black uppercase bg-black/60 px-5 py-2 rounded-lg italic border border-red-900/30 shadow-lg" style="font-family: 'Cinzel', serif; letter-spacing: 2px;">KRVAV√ù K√öCAN</div>
            <div id="myInfo" class="text-gray-300 font-medium tracking-wide"></div>
        </div>

        <div id="stControls" class="hidden flex gap-3">
            <button onclick="distributeRoles()" class="st-btn st-btn-roles">
                <span>üîÆ</span> Rozda≈• Osud
            </button>
            <button onclick="toggleTime()" class="st-btn st-btn-time">
                <span>üåó</span> Cyklus
            </button>
            <button id="shufflePlayersBtn" onclick="shufflePlayers()" class="st-btn st-btn-time">
                <span>üîÄ</span> Zamie≈°a≈• hr√°ƒçov
            </button>
            <button onclick="hardReset()" class="st-btn st-btn-reset">
                <span>‚ò†Ô∏è</span> Z√°nik
            </button>
        </div>

        <div class="flex items-center gap-3">
            <div id="aliveCounter" class="alive-counter">≈Ωiv√≠: ?</div>
            <div id="curTime" class="time-badge">DE≈á</div>
        </div>
    </header>

    <aside class="sidebar"><div id="roleList" class="space-y-4 text-xs"></div></aside>

    <main class="main-area">
        <div id="roundTable" class="round-table" title="Klikni (ST) pre nastavenie odpoƒçtu">
            <div id="votingButtons" class="hidden absolute inset-0 flex items-center justify-center gap-6 z-10">
                <button id="voteYesBtn" class="vote-btn vote-yes">√ÅNO</button>
                <button id="voteNoBtn" class="vote-btn vote-no">NIE</button>
            </div>

            <!-- TIMER OVERLAY -->
            <div id="timerOverlay" class="timer-overlay hidden">
                <div class="timer-ring" style="--pct:0%;">
                    <div class="timer-core">
                        <div class="timer-text" id="timerText">00:00</div>
                        <div class="timer-mini" id="timerMini">Odpoƒç√≠tavanie</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="tableCircle" class="w-full h-full relative"></div>

        <!-- ST: ovl√°danie hlasovania mimo stola -->
        <div id="stVotingBar" class="st-voting-bar hidden">
            <button onclick="endVoting()" class="st-voting-btn">Ukonƒçi≈• hlasovanie</button>
            <button onclick="cancelVoting()" class="st-voting-btn st-voting-cancel">Zru≈°i≈•</button>
        </div>

        <!-- NOMINATION BANNER (mimo stola) -->
        <div id="nominationBanner" class="nomination-banner hidden">
            <div class="nomination-banner-inner">
                <span class="nomination-label">Nominovan√Ω:</span>
                <span id="nominationName" class="nomination-value">‚Äî</span>
            </div>
        </div>

    </main>

    <aside class="sidebar border-l-2 border-gray-800 flex flex-col gap-3">
        <h3 class="section-header text-xs font-black text-gray-500 border-b-2 border-gray-800 uppercase text-center pb-2">Po≈°ta</h3>
        <div id="chatContacts" class="hidden chat-contacts-list"></div>
        <div id="allChats" class="flex-1 overflow-y-auto"></div>
    </aside>
</div>

<!-- ST Modal -->
<div id="stModal" class="hidden fixed inset-0 bg-black/95 z-[4000] flex items-center justify-center backdrop-blur-sm">
    <div class="bg-gradient-to-br from-gray-900 via-black to-gray-900 p-8 rounded-2xl border-2 border-red-900 w-full max-w-sm text-center shadow-2xl">
        <h2 id="targetName" class="text-2xl font-bold mb-6 text-white uppercase italic" style="font-family: 'Cinzel', serif;"></h2>
        <div class="grid grid-cols-2 gap-3 text-xs font-bold uppercase">
            <button onclick="stAction('is_nominated')" class="bg-gradient-to-r from-orange-600 to-orange-700 p-5 rounded-lg text-white col-span-2 text-base shadow-lg hover:from-orange-500 hover:to-orange-600 transition">üì¢ NOMINOVA≈§</button>
            <button onclick="stAction('is_dead')" class="bg-gradient-to-r from-red-600 to-red-700 p-5 rounded-lg text-white shadow-lg hover:from-red-500 hover:to-red-600 transition">Zabi≈• / O≈æivi≈•</button>
            <button onclick="stAction('status_drunk')" class="bg-gradient-to-r from-amber-700 to-amber-800 p-5 rounded-lg text-white shadow-lg hover:from-amber-600 hover:to-amber-700 transition">üç∫ OPIT√ù</button>
            <button onclick="stAction('status_poisoned')" class="bg-gradient-to-r from-purple-700 to-purple-800 p-5 rounded-lg text-white shadow-lg hover:from-purple-600 hover:to-purple-700 transition">üß™ OTR√ÅVEN√ù</button>
            <button onclick="stAction('status_protected')" class="bg-gradient-to-r from-blue-700 to-blue-800 p-5 rounded-lg text-white shadow-lg hover:from-blue-600 hover:to-blue-700 transition">üõ°Ô∏è CHR√ÅNEN√ù</button>
            <button onclick="stAction('status_grandchild')" class="bg-gradient-to-r from-green-700 to-green-800 p-5 rounded-lg text-white col-span-2 shadow-lg hover:from-green-600 hover:to-green-700 transition">üë∂ VNUK</button>
            <button onclick="closeSt()" class="w-full mt-5 text-gray-400 hover:text-white underline col-span-2 text-sm transition">Zavrie≈•</button>
        </div>
    </div>
</div>

<!-- NOTE Modal -->
<div id="noteModal" class="hidden fixed inset-0 bg-black/95 z-[4000] flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-gradient-to-br from-gray-900 via-black to-gray-900 p-6 rounded-2xl border-2 border-blue-900 w-full max-w-sm max-h-[80vh] flex flex-col text-white shadow-2xl">
        <h2 id="noteTargetName" class="text-xl font-bold mb-5 uppercase text-center italic" style="font-family: 'Cinzel', serif;">Tip na rolu</h2>
        <div id="noteRoleList" class="flex-1 overflow-y-auto grid grid-cols-2 gap-2 text-[10px] font-bold"></div>
        <button onclick="closeNote()" class="mt-5 bg-gradient-to-r from-gray-800 to-gray-900 p-4 rounded-lg font-bold uppercase text-xs shadow-lg hover:from-gray-700 hover:to-gray-800 transition">Zavrie≈•</button>
    </div>
</div>

<!-- VOTING Modal -->
<div id="votingModal" class="hidden fixed inset-0 bg-black/95 z-[4000] flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-gradient-to-br from-gray-900 via-black to-gray-900 p-8 rounded-2xl border-2 border-orange-900 w-full max-w-4xl max-h-[90vh] flex flex-col text-white shadow-2xl">
        <h2 id="votingTitle" class="text-2xl font-bold mb-6 text-center uppercase italic" style="font-family: 'Cinzel', serif;">Hlasovanie</h2>
        <div id="votingControls" class="mb-6 flex justify-center gap-4"></div>
        <div id="votingCards" class="flex-1 overflow-y-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
    </div>
</div>

<!-- TIMER Modal (ST only) -->
<div id="timerModal" class="hidden fixed inset-0 bg-black/90 z-[4500] flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="modal-inner p-6 w-full max-w-sm text-white" style="background:linear-gradient(135deg,#0b0a0d 0%,#1a0f13 100%); border:2px solid #8b0000; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,0.6);">
        <h2 class="text-2xl font-black uppercase italic text-center mb-4" style="font-family:'Cinzel',serif">Odpoƒç√≠tavanie</h2>
        <div class="space-y-3">
            <label class="text-xs uppercase tracking-widest text-gray-400">Min√∫ty</label>
            <input id="timerMinutes" type="number" min="1" max="180" value="10" class="w-full bg-black/60 border-2 border-gray-800 text-white rounded-lg p-3 focus:border-red-700 outline-none">
            <div class="grid grid-cols-2 gap-3 mt-3">
                <button onclick="startTimerFromModal()" class="st-btn st-btn-time p-3 text-sm">‚ñ∂Ô∏è Spusti≈•</button>
                <button onclick="closeTimerModal()" class="st-btn st-btn-reset p-3 text-sm">‚úñÔ∏è Zavrie≈•</button>
            </div>
            <div class="grid grid-cols-3 gap-3 mt-2">
                <button onclick="pauseTimer()" class="st-btn st-btn-time p-3 text-xs">‚è∏Ô∏è Pozastavi≈•</button>
                <button onclick="resumeTimer()" class="st-btn st-btn-time p-3 text-xs">‚èµ Pokraƒçova≈•</button>
                <button onclick="resetTimer()" class="st-btn st-btn-reset p-3 text-xs">‚ü≤ Reset</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>
